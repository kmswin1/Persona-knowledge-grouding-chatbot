INFO:train_focus.py:Arguments: Namespace(bart_model_path='facebook/bart-base', dev_dataset_cache='data/focus_cache.tar.gz', dev_dataset_path='data/valid_focus.json', device='cuda', eval_before_start=False, flag='E2_L10', fp16='', gpt2_model_path='gpt2', gpu_start_num=1, gradient_accumulation_steps=16, incontext=True, inference=False, kn_coef=1.0, lm_coef=10.0, local_rank=-1, lr=6.25e-05, max_history=1, max_norm=1.0, model_name='GPT2', n_epochs=2, ps_coef=1.0, random_knowledge=False, seed=19950604, test_infer=False, train_batch_size=4, train_dataset_cache='data/focus_cache.tar.gz', train_dataset_path='data/train_focus.json', valid_batch_size=1)
INFO:train_focus.py:Prepare tokenizer, pretrained model and optimizer.
Downloading:   0%|          | 0.00/1.04M [00:00<?, ?B/s]Downloading:   4%|▍         | 43.0k/1.04M [00:00<00:03, 273kB/s]Downloading:  19%|█▉        | 197k/1.04M [00:00<00:01, 674kB/s] Downloading:  70%|███████   | 730k/1.04M [00:00<00:00, 2.28MB/s]Downloading: 100%|██████████| 1.04M/1.04M [00:00<00:00, 2.10MB/s]
Downloading:   0%|          | 0.00/456k [00:00<?, ?B/s]Downloading:   8%|▊         | 36.9k/456k [00:00<00:01, 214kB/s]Downloading:  39%|███▉      | 180k/456k [00:00<00:00, 646kB/s] Downloading:  86%|████████▌ | 393k/456k [00:00<00:00, 1.15MB/s]Downloading: 100%|██████████| 456k/456k [00:00<00:00, 1.08MB/s]
Downloading:   0%|          | 0.00/1.36M [00:00<?, ?B/s]Downloading:   3%|▎         | 41.0k/1.36M [00:00<00:05, 255kB/s]Downloading:  13%|█▎        | 172k/1.36M [00:00<00:02, 520kB/s] Downloading:  37%|███▋      | 497k/1.36M [00:00<00:00, 1.38MB/s]Downloading:  95%|█████████▍| 1.29M/1.36M [00:00<00:00, 3.42MB/s]Downloading: 100%|██████████| 1.36M/1.36M [00:00<00:00, 2.42MB/s]
Downloading:   0%|          | 0.00/665 [00:00<?, ?B/s]Downloading: 100%|██████████| 665/665 [00:00<00:00, 343kB/s]
Downloading:   0%|          | 0.00/548M [00:00<?, ?B/s]Downloading:   0%|          | 114k/548M [00:00<08:26, 1.08MB/s]Downloading:   0%|          | 540k/548M [00:00<03:15, 2.80MB/s]Downloading:   0%|          | 1.14M/548M [00:00<02:40, 3.40MB/s]Downloading:   0%|          | 1.98M/548M [00:00<01:49, 4.99MB/s]Downloading:   1%|          | 3.02M/548M [00:00<01:21, 6.72MB/s]Downloading:   1%|          | 5.10M/548M [00:00<00:48, 11.2MB/s]Downloading:   1%|▏         | 6.91M/548M [00:00<00:56, 9.53MB/s]Downloading:   2%|▏         | 10.5M/548M [00:01<00:36, 14.9MB/s]Downloading:   2%|▏         | 12.1M/548M [00:01<00:35, 15.2MB/s]Downloading:   3%|▎         | 13.8M/548M [00:01<00:34, 15.5MB/s]Downloading:   3%|▎         | 16.0M/548M [00:01<00:30, 17.3MB/s]Downloading:   3%|▎         | 17.8M/548M [00:01<00:32, 16.1MB/s]Downloading:   4%|▎         | 19.5M/548M [00:01<00:52, 9.99MB/s]Downloading:   4%|▍         | 23.3M/548M [00:01<00:34, 15.3MB/s]Downloading:   5%|▍         | 25.4M/548M [00:02<00:31, 16.4MB/s]Downloading:   5%|▌         | 27.6M/548M [00:02<00:29, 17.7MB/s]Downloading:   6%|▌         | 30.3M/548M [00:02<00:26, 19.5MB/s]Downloading:   6%|▌         | 33.4M/548M [00:02<00:22, 22.4MB/s]Downloading:   7%|▋         | 36.1M/548M [00:02<00:21, 23.6MB/s]Downloading:   7%|▋         | 39.2M/548M [00:02<00:19, 25.5MB/s]Downloading:   8%|▊         | 41.9M/548M [00:02<00:19, 25.9MB/s]Downloading:   8%|▊         | 44.6M/548M [00:02<00:26, 19.2MB/s]Downloading:   9%|▉         | 48.2M/548M [00:02<00:21, 23.0MB/s]Downloading:   9%|▉         | 51.3M/548M [00:03<00:20, 24.7MB/s]Downloading:  10%|█         | 55.2M/548M [00:03<00:17, 28.1MB/s]Downloading:  11%|█         | 58.6M/548M [00:03<00:16, 29.6MB/s]Downloading:  11%|█▏        | 61.7M/548M [00:03<00:18, 25.7MB/s]Downloading:  12%|█▏        | 64.5M/548M [00:03<00:18, 25.8MB/s]Downloading:  12%|█▏        | 67.5M/548M [00:03<00:17, 26.8MB/s]Downloading:  13%|█▎        | 70.3M/548M [00:03<00:22, 21.2MB/s]Downloading:  13%|█▎        | 73.9M/548M [00:03<00:19, 24.5MB/s]Downloading:  14%|█▍        | 76.6M/548M [00:04<00:19, 24.3MB/s]Downloading:  14%|█▍        | 79.2M/548M [00:04<00:21, 21.9MB/s]Downloading:  15%|█▍        | 81.6M/548M [00:04<00:21, 21.5MB/s]Downloading:  15%|█▌        | 84.1M/548M [00:04<00:20, 22.4MB/s]Downloading:  16%|█▌        | 86.4M/548M [00:04<00:25, 17.9MB/s]Downloading:  16%|█▋        | 89.4M/548M [00:04<00:22, 20.6MB/s]Downloading:  17%|█▋        | 91.9M/548M [00:04<00:21, 21.7MB/s]Downloading:  17%|█▋        | 94.2M/548M [00:05<00:25, 17.8MB/s]Downloading:  18%|█▊        | 97.3M/548M [00:05<00:21, 20.7MB/s]Downloading:  18%|█▊        | 100M/548M [00:05<00:20, 22.0MB/s] Downloading:  19%|█▊        | 102M/548M [00:05<00:20, 21.9MB/s]Downloading:  19%|█▉        | 105M/548M [00:05<00:20, 21.9MB/s]Downloading:  20%|█▉        | 107M/548M [00:05<00:23, 18.9MB/s]Downloading:  20%|██        | 110M/548M [00:05<00:21, 20.5MB/s]Downloading:  20%|██        | 112M/548M [00:05<00:24, 18.0MB/s]Downloading:  21%|██        | 115M/548M [00:05<00:20, 21.0MB/s]Downloading:  21%|██▏       | 117M/548M [00:06<00:27, 15.9MB/s]Downloading:  22%|██▏       | 119M/548M [00:06<00:31, 13.7MB/s]Downloading:  22%|██▏       | 122M/548M [00:06<00:25, 16.7MB/s]Downloading:  23%|██▎       | 124M/548M [00:06<00:25, 16.9MB/s]Downloading:  23%|██▎       | 127M/548M [00:06<00:21, 19.5MB/s]Downloading:  24%|██▎       | 129M/548M [00:06<00:29, 14.0MB/s]Downloading:  24%|██▍       | 133M/548M [00:07<00:22, 18.3MB/s]Downloading:  25%|██▍       | 135M/548M [00:07<00:29, 14.2MB/s]Downloading:  25%|██▌       | 137M/548M [00:07<00:26, 15.6MB/s]Downloading:  25%|██▌       | 139M/548M [00:07<00:25, 15.9MB/s]Downloading:  26%|██▌       | 141M/548M [00:07<00:25, 15.9MB/s]Downloading:  26%|██▌       | 143M/548M [00:07<00:31, 12.8MB/s]Downloading:  27%|██▋       | 146M/548M [00:08<00:22, 17.5MB/s]Downloading:  27%|██▋       | 149M/548M [00:08<00:21, 18.4MB/s]Downloading:  28%|██▊       | 151M/548M [00:08<00:20, 19.4MB/s]Downloading:  28%|██▊       | 154M/548M [00:08<00:18, 21.5MB/s]Downloading:  28%|██▊       | 156M/548M [00:08<00:18, 21.5MB/s]Downloading:  29%|██▉       | 158M/548M [00:08<00:23, 16.7MB/s]Downloading:  29%|██▉       | 161M/548M [00:08<00:19, 19.6MB/s]Downloading:  30%|███       | 164M/548M [00:08<00:17, 21.9MB/s]Downloading:  30%|███       | 167M/548M [00:08<00:16, 22.9MB/s]Downloading:  31%|███       | 170M/548M [00:09<00:19, 19.0MB/s]Downloading:  31%|███▏      | 172M/548M [00:09<00:18, 20.5MB/s]Downloading:  32%|███▏      | 174M/548M [00:09<00:22, 16.8MB/s]Downloading:  32%|███▏      | 177M/548M [00:09<00:19, 18.9MB/s]Downloading:  33%|███▎      | 179M/548M [00:09<00:25, 14.5MB/s]Downloading:  33%|███▎      | 181M/548M [00:09<00:22, 16.1MB/s]Downloading:  33%|███▎      | 183M/548M [00:10<00:22, 16.0MB/s]Downloading:  34%|███▍      | 186M/548M [00:10<00:21, 16.8MB/s]Downloading:  34%|███▍      | 187M/548M [00:10<00:37, 9.55MB/s]Downloading:  34%|███▍      | 189M/548M [00:10<00:37, 9.68MB/s]Downloading:  35%|███▍      | 190M/548M [00:10<00:37, 9.56MB/s]Downloading:  35%|███▌      | 193M/548M [00:10<00:28, 12.6MB/s]Downloading:  35%|███▌      | 194M/548M [00:11<00:26, 13.3MB/s]Downloading:  36%|███▌      | 197M/548M [00:11<00:23, 15.2MB/s]Downloading:  36%|███▋      | 199M/548M [00:11<00:20, 16.8MB/s]Downloading:  37%|███▋      | 201M/548M [00:11<00:30, 11.3MB/s]Downloading:  37%|███▋      | 204M/548M [00:11<00:22, 15.3MB/s]Downloading:  38%|███▊      | 206M/548M [00:11<00:25, 13.3MB/s]Downloading:  38%|███▊      | 208M/548M [00:12<00:27, 12.4MB/s]Downloading:  38%|███▊      | 210M/548M [00:12<00:23, 14.5MB/s]Downloading:  39%|███▊      | 212M/548M [00:12<00:21, 15.7MB/s]Downloading:  39%|███▉      | 214M/548M [00:12<00:19, 17.3MB/s]Downloading:  40%|███▉      | 217M/548M [00:12<00:17, 19.2MB/s]Downloading:  40%|███▉      | 219M/548M [00:12<00:16, 20.5MB/s]Downloading:  40%|████      | 222M/548M [00:12<00:14, 22.3MB/s]Downloading:  41%|████      | 224M/548M [00:12<00:14, 22.9MB/s]Downloading:  42%|████▏     | 228M/548M [00:12<00:12, 25.5MB/s]Downloading:  42%|████▏     | 230M/548M [00:12<00:12, 25.5MB/s]Downloading:  43%|████▎     | 233M/548M [00:13<00:11, 27.2MB/s]Downloading:  43%|████▎     | 237M/548M [00:13<00:10, 28.6MB/s]Downloading:  44%|████▎     | 240M/548M [00:13<00:17, 17.5MB/s]Downloading:  44%|████▍     | 243M/548M [00:13<00:14, 21.2MB/s]Downloading:  45%|████▍     | 246M/548M [00:13<00:13, 22.8MB/s]Downloading:  46%|████▌     | 250M/548M [00:13<00:11, 27.1MB/s]Downloading:  46%|████▌     | 253M/548M [00:13<00:10, 28.7MB/s]Downloading:  47%|████▋     | 257M/548M [00:13<00:09, 29.8MB/s]Downloading:  47%|████▋     | 260M/548M [00:14<00:09, 30.9MB/s]Downloading:  48%|████▊     | 263M/548M [00:14<00:09, 31.4MB/s]Downloading:  49%|████▊     | 266M/548M [00:14<00:10, 26.9MB/s]Downloading:  49%|████▉     | 269M/548M [00:14<00:12, 22.5MB/s]Downloading:  50%|████▉     | 272M/548M [00:14<00:13, 20.7MB/s]Downloading:  50%|█████     | 274M/548M [00:14<00:16, 16.6MB/s]Downloading:  51%|█████     | 277M/548M [00:14<00:14, 18.7MB/s]Downloading:  51%|█████     | 279M/548M [00:15<00:13, 20.4MB/s]Downloading:  51%|█████▏    | 282M/548M [00:15<00:13, 19.8MB/s]Downloading:  52%|█████▏    | 284M/548M [00:15<00:13, 20.1MB/s]Downloading:  52%|█████▏    | 286M/548M [00:15<00:13, 20.0MB/s]Downloading:  53%|█████▎    | 288M/548M [00:15<00:13, 19.1MB/s]Downloading:  53%|█████▎    | 290M/548M [00:15<00:14, 18.3MB/s]Downloading:  53%|█████▎    | 292M/548M [00:15<00:14, 18.2MB/s]Downloading:  54%|█████▎    | 294M/548M [00:15<00:12, 19.6MB/s]Downloading:  54%|█████▍    | 296M/548M [00:16<00:13, 18.2MB/s]Downloading:  54%|█████▍    | 298M/548M [00:16<00:17, 14.7MB/s]Downloading:  55%|█████▍    | 301M/548M [00:16<00:13, 18.3MB/s]Downloading:  55%|█████▌    | 303M/548M [00:16<00:14, 17.4MB/s]Downloading:  56%|█████▌    | 305M/548M [00:16<00:14, 17.2MB/s]Downloading:  56%|█████▌    | 307M/548M [00:16<00:14, 16.2MB/s]Downloading:  56%|█████▋    | 309M/548M [00:16<00:14, 16.6MB/s]Downloading:  57%|█████▋    | 310M/548M [00:16<00:16, 14.5MB/s]Downloading:  57%|█████▋    | 314M/548M [00:17<00:11, 20.1MB/s]Downloading:  58%|█████▊    | 317M/548M [00:17<00:10, 21.7MB/s]Downloading:  58%|█████▊    | 319M/548M [00:17<00:10, 21.9MB/s]Downloading:  59%|█████▊    | 322M/548M [00:17<00:09, 22.7MB/s]Downloading:  59%|█████▉    | 325M/548M [00:17<00:09, 24.2MB/s]Downloading:  60%|█████▉    | 327M/548M [00:17<00:08, 24.8MB/s]Downloading:  60%|██████    | 330M/548M [00:17<00:08, 24.9MB/s]Downloading:  61%|██████    | 333M/548M [00:17<00:08, 26.0MB/s]Downloading:  61%|██████    | 335M/548M [00:18<00:13, 15.7MB/s]Downloading:  62%|██████▏   | 338M/548M [00:18<00:11, 17.9MB/s]Downloading:  62%|██████▏   | 340M/548M [00:18<00:10, 19.1MB/s]Downloading:  63%|██████▎   | 343M/548M [00:18<00:09, 22.3MB/s]Downloading:  63%|██████▎   | 346M/548M [00:18<00:11, 18.4MB/s]Downloading:  64%|██████▎   | 349M/548M [00:18<00:09, 21.3MB/s]Downloading:  64%|██████▍   | 352M/548M [00:18<00:08, 22.0MB/s]Downloading:  65%|██████▍   | 354M/548M [00:18<00:08, 22.9MB/s]Downloading:  65%|██████▌   | 357M/548M [00:18<00:07, 24.8MB/s]Downloading:  66%|██████▌   | 360M/548M [00:19<00:10, 18.6MB/s]Downloading:  66%|██████▋   | 363M/548M [00:19<00:08, 21.8MB/s]Downloading:  67%|██████▋   | 366M/548M [00:19<00:10, 17.3MB/s]Downloading:  68%|██████▊   | 370M/548M [00:19<00:07, 22.5MB/s]Downloading:  68%|██████▊   | 373M/548M [00:19<00:08, 21.3MB/s]Downloading:  68%|██████▊   | 375M/548M [00:19<00:08, 20.8MB/s]Downloading:  69%|██████▉   | 378M/548M [00:20<00:09, 18.2MB/s]Downloading:  70%|██████▉   | 381M/548M [00:20<00:07, 22.2MB/s]Downloading:  70%|██████▉   | 384M/548M [00:20<00:07, 21.4MB/s]Downloading:  70%|███████   | 386M/548M [00:20<00:07, 21.2MB/s]Downloading:  71%|███████   | 389M/548M [00:20<00:06, 24.3MB/s]Downloading:  72%|███████▏  | 392M/548M [00:20<00:06, 25.9MB/s]Downloading:  72%|███████▏  | 395M/548M [00:20<00:07, 21.6MB/s]Downloading:  73%|███████▎  | 397M/548M [00:20<00:06, 21.8MB/s]Downloading:  73%|███████▎  | 400M/548M [00:21<00:07, 20.4MB/s]Downloading:  74%|███████▎  | 403M/548M [00:21<00:06, 23.1MB/s]Downloading:  74%|███████▍  | 406M/548M [00:21<00:05, 23.8MB/s]Downloading:  74%|███████▍  | 408M/548M [00:21<00:07, 18.7MB/s]Downloading:  75%|███████▍  | 410M/548M [00:21<00:07, 18.2MB/s]Downloading:  75%|███████▌  | 413M/548M [00:21<00:06, 20.1MB/s]Downloading:  76%|███████▌  | 415M/548M [00:21<00:07, 18.7MB/s]Downloading:  76%|███████▋  | 418M/548M [00:21<00:05, 22.0MB/s]Downloading:  77%|███████▋  | 421M/548M [00:22<00:07, 17.5MB/s]Downloading:  77%|███████▋  | 423M/548M [00:22<00:07, 15.9MB/s]Downloading:  78%|███████▊  | 425M/548M [00:22<00:07, 17.4MB/s]Downloading:  78%|███████▊  | 427M/548M [00:22<00:07, 17.0MB/s]Downloading:  79%|███████▊  | 431M/548M [00:22<00:05, 21.6MB/s]Downloading:  79%|███████▉  | 434M/548M [00:22<00:05, 22.6MB/s]Downloading:  80%|███████▉  | 436M/548M [00:22<00:06, 18.2MB/s]Downloading:  80%|████████  | 439M/548M [00:23<00:05, 21.5MB/s]Downloading:  81%|████████  | 442M/548M [00:23<00:04, 22.8MB/s]Downloading:  81%|████████  | 445M/548M [00:23<00:04, 21.8MB/s]Downloading:  82%|████████▏ | 447M/548M [00:23<00:04, 21.2MB/s]Downloading:  82%|████████▏ | 449M/548M [00:23<00:04, 20.4MB/s]Downloading:  82%|████████▏ | 452M/548M [00:23<00:04, 22.0MB/s]Downloading:  83%|████████▎ | 455M/548M [00:23<00:04, 23.3MB/s]Downloading:  83%|████████▎ | 457M/548M [00:23<00:03, 23.3MB/s]Downloading:  84%|████████▍ | 461M/548M [00:23<00:03, 25.8MB/s]Downloading:  85%|████████▍ | 463M/548M [00:24<00:03, 21.9MB/s]Downloading:  85%|████████▌ | 466M/548M [00:24<00:04, 18.9MB/s]Downloading:  85%|████████▌ | 468M/548M [00:24<00:07, 10.5MB/s]Downloading:  86%|████████▌ | 472M/548M [00:24<00:05, 14.7MB/s]Downloading:  87%|████████▋ | 475M/548M [00:25<00:04, 15.7MB/s]Downloading:  87%|████████▋ | 477M/548M [00:25<00:04, 17.6MB/s]Downloading:  87%|████████▋ | 480M/548M [00:25<00:04, 15.1MB/s]Downloading:  88%|████████▊ | 484M/548M [00:25<00:03, 20.1MB/s]Downloading:  89%|████████▊ | 486M/548M [00:25<00:02, 21.0MB/s]Downloading:  89%|████████▉ | 489M/548M [00:25<00:02, 22.6MB/s]Downloading:  90%|████████▉ | 492M/548M [00:25<00:02, 22.6MB/s]Downloading:  90%|█████████ | 495M/548M [00:25<00:02, 25.1MB/s]Downloading:  91%|█████████ | 498M/548M [00:26<00:02, 19.4MB/s]Downloading:  91%|█████████▏| 501M/548M [00:26<00:02, 22.0MB/s]Downloading:  92%|█████████▏| 505M/548M [00:26<00:01, 25.8MB/s]Downloading:  93%|█████████▎| 508M/548M [00:26<00:01, 20.8MB/s]Downloading:  93%|█████████▎| 511M/548M [00:26<00:01, 22.7MB/s]Downloading:  94%|█████████▎| 513M/548M [00:26<00:01, 20.5MB/s]Downloading:  94%|█████████▍| 517M/548M [00:26<00:01, 24.3MB/s]Downloading:  95%|█████████▍| 520M/548M [00:26<00:01, 25.5MB/s]Downloading:  95%|█████████▌| 523M/548M [00:27<00:01, 20.9MB/s]Downloading:  96%|█████████▌| 527M/548M [00:27<00:00, 25.5MB/s]Downloading:  97%|█████████▋| 530M/548M [00:27<00:00, 26.3MB/s]Downloading:  97%|█████████▋| 533M/548M [00:27<00:00, 28.6MB/s]Downloading:  98%|█████████▊| 536M/548M [00:27<00:00, 28.1MB/s]Downloading:  98%|█████████▊| 539M/548M [00:27<00:00, 23.2MB/s]Downloading:  99%|█████████▉| 542M/548M [00:27<00:00, 23.1MB/s]Downloading:  99%|█████████▉| 544M/548M [00:27<00:00, 22.8MB/s]Downloading: 100%|█████████▉| 547M/548M [00:28<00:00, 19.8MB/s]Downloading: 100%|██████████| 548M/548M [00:28<00:00, 19.4MB/s]
Some weights of GPT2PK_ctxt were not initialized from the model checkpoint at gpt2 and are newly initialized: ['summary.summary.weight', 'attn1.weight', 'concat_summary.summary.weight', 'attn2.weight', 'concat_summary.summary.bias', 'attn1.bias', 'summary.summary.bias', 'attn2.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
INFO:train_focus.py:Prepare datasets
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/utils_focus.py:Process dataset from data/train_focus.json
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/utils_focus.py:Tokenize and encode the dataset
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/utils_focus.py:Tokenize and encode the dataset
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/data_utils.py:Build inputs and labels
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/data_utils.py:Pad inputs and convert to Tensor
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/data_utils.py:Build train and validation dataloaders
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/data_utils.py:Train dataset (Batch, Candidates, Seq length): torch.Size([70332, 392])
INFO:/home/omsus20/Projects/constrained-persona-knowlege-chat/data_utils.py:Valid dataset (Batch, Candidates, Seq length): torch.Size([5639, 254])
INFO:ignite.engine.engine.Engine:Engine run starting with max_epochs=2.
ERROR:ignite.engine.engine.Engine:Current run is terminating due to exception: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.69 GiB total capacity; 22.29 GiB already allocated; 35.44 MiB free; 22.74 GiB reserved in total by PyTorch)
ERROR:ignite.engine.engine.Engine:Engine run is terminating due to exception: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.69 GiB total capacity; 22.29 GiB already allocated; 35.44 MiB free; 22.74 GiB reserved in total by PyTorch)
<pad> token added!
orig num 50257 num_added 5
train 12484
valid 1000
remove list:  0
remove list:  0
Traceback (most recent call last):
  File "train_focus.py", line 370, in <module>
    train()
  File "train_focus.py", line 361, in train
    trainer.run(train_loader, max_epochs=args.n_epochs)
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 715, in run
    return self._internal_run()
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 788, in _internal_run
    self._handle_exception(e)
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 470, in _handle_exception
    raise e
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 758, in _internal_run
    time_taken = self._run_once_on_dataset()
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 873, in _run_once_on_dataset
    self._handle_exception(e)
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 470, in _handle_exception
    raise e
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/ignite/engine/engine.py", line 852, in _run_once_on_dataset
    self.state.output = self._process_function(self, self.state.batch)
  File "train_focus.py", line 168, in update
    mc_token_ids=mc_token_ids
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/omsus20/Projects/constrained-persona-knowlege-chat/classification_modules.py", line 234, in forward
    dynamic_lm_hidden_states = self.transformer(input_ids=input_ids, token_type_ids=token_type_ids)['last_hidden_state']
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 801, in forward
    output_attentions=output_attentions,
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 355, in forward
    feed_forward_hidden_states = self.mlp(hidden_states)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 285, in forward
    hidden_states = self.dropout(hidden_states)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/modules/dropout.py", line 54, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "/home/omsus20/miniconda3/envs/constrain/lib/python3.7/site-packages/torch/nn/functional.py", line 936, in dropout
    else _VF.dropout(input, p, training))
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 23.69 GiB total capacity; 22.29 GiB already allocated; 35.44 MiB free; 22.74 GiB reserved in total by PyTorch)
